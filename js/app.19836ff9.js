(function(e){function t(t){for(var r,c,o=t[0],s=t[1],u=t[2],f=0,d=[];f<o.length;f++)c=o[f],Object.prototype.hasOwnProperty.call(a,c)&&a[c]&&d.push(a[c][0]),a[c]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(d.length)d.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,o=1;o<n.length;o++){var s=n[o];0!==a[s]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},a={app:0},i=[];function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0565":function(e,t,n){"use strict";(function(e){var r=n("1da1"),a=(n("96cf"),n("99af"),n("b0c0"),n("7327")),i=n("731b"),c=n("25f1"),o=n("eaa5"),s=n("73ec");t["a"]={name:"FileSelector",data:function(){return{task_all:0,task_finished:0,queue:new s["a"],parallel:!1}},computed:{progress_value:function(){return this.task_all?this.task_finished/this.task_all*100:0},progress_show:function(){return this.task_all!==this.task_finished}},mounted:function(){window.Worker&&"file:"!==window.location.protocol?(console.log("Using Worker Pool"),this.queue=Object(a["a"])((function(){return Object(i["a"])(new c["a"](e))}),navigator.hardwareConcurrency||1),this.parallel=!0):console.log("Using Queue in Main Thread")},methods:{progress_string:function(){return"".concat(this.task_finished," / ").concat(this.task_all)},addFile:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:t.task_all++,t.queue.queue(Object(r["a"])(regeneratorRuntime.mark((function n(){var r,a=arguments;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:o["a"],console.log("start handling",e.name),n.prev=2,n.t0=t,n.next=6,r(e);case 6:n.t1=n.sent,n.t0.$emit.call(n.t0,"success",n.t1),n.next=14;break;case 10:n.prev=10,n.t2=n["catch"](2),console.error(n.t2),t.$emit("error",n.t2,e.name);case 14:return n.prev=14,t.task_finished++,n.finish(14);case 17:case"end":return n.stop()}}),n,null,[[2,10,14,17]])}))));case 2:case"end":return n.stop()}}),n)})))()}}}}).call(this,n("2e83"))},1:function(e,t){},2:function(e,t){},"29c8":function(e,t,n){},"2e83":function(e,t,n){e.exports=n.p+"js/0.d80f3e15.worker.js"},3:function(e,t){},3349:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return m}));n("d3b7"),n("159b"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("a630"),n("3ca3"),n("fb6a"),n("b64b"),n("a9e3"),n("99af");var r=n("cc74"),a=[79,103,103,83,0,2,0,0,0,0,0,0,0,0,255,255,255,255,0,0,0,0,255,255,255,255,1,30,1,118,111,114,98,105,115,0,0,0,0,2,68,172,0,0,0,0,0,0,0,238,2,0,0,0,0,0,184,1,79,103,103,83,0,0,0,0,0,0,0,0,0,0,255,255,255,255,1,0,0,0,255,255,255,255],i=[3,118,111,114,98,105,115,44,0,0,0,88,105,112,104,46,79,114,103,32,108,105,98,86,111,114,98,105,115,32,73,32,50,48,49,53,48,49,48,53,32,40,226,155,132,226,155,132,226,155,132,226,155,132,41,255,0,0,0,255,0,0,0,84,73,84,76,69,61],c=[9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0,9,9,9,9,9,9,9,9,9,9,9,9,9,6,3,3,3,3,6,6,6,6,3,3,3,3,6,6,6,6,6,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,0,0,0,0,9,9,9,9,0,0,0,0],o=[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,0,1,3,3,0,1,3,3,3,3,3,3,3,3],s=[222,81,250,195,74,214,202,144,126,103,94,247,213,82,132,216,71,149,187,161,170,198,102,35,146,98,243,116,161,159,244,160,29,63,91,240,19,14,9,61,249,188,0,17],u=[],l=[];(function(){for(var e=0;e<128;e++){var t=(e*e+27)%256;t in u?u[t].push(e):u[t]=[e]}var n=0;u.forEach((function(e){e.forEach((function(e){l[e]=n})),n++}))})();var f=function(){function e(e){if(e instanceof Uint8Array&&(e=Array.from(e)),44===e.length)this.Matrix128=this._generate128(e);else{if(128!==e.length)throw Error("invalid mask length");this.Matrix128=e}}return e.prototype.getMatrix128=function(){return this.Matrix128},e.prototype.getMatrix44=function(){var e=this,t=[],n=0;return u.forEach((function(r){for(var a=r.length,i=1;i<a;i++)if(e.Matrix128[r[0]]!==e.Matrix128[r[i]])throw"decode mask-128 to mask-44 failed";t[n]=e.Matrix128[r[0]],n++})),t},e.prototype.Decrypt=function(e){if(!this.Matrix128)throw Error("bad call sequence");for(var t=e.slice(0),n=-1,r=-1,a=0;a<e.length;a++)n++,r++,(32768===n||n>32768&&(n+1)%32768===0)&&(n++,r++),r>=128&&(r-=128),t[a]^=this.Matrix128[r];return t},e.prototype._generate128=function(e){var t=[],n=0;return u.forEach((function(r){r.forEach((function(r){t[r]=e[n]})),n++})),t},e}();function d(){return new f(s)}function b(e){for(var t=Math.min(32768,e.length),n=0;n<t;n+=128)try{var a=new f(e.slice(n,n+128));if(Object(r["b"])(a.Decrypt(e.slice(0,r["c"].length)),r["c"]))return a}catch(i){}}function m(e){if(!(e.length<256)){for(var t={},n=0;n<44;n++)t[n]={};for(var i=e[84]^e[12]^a[12],c=p(i),o=v(i),s=0;s<c.length;s++)if(0!==o[s]){var u=l[s%128],d=e[s]^c[s],b=o[s];d in t[u]?t[u][d]+=b:t[u][d]=b}var m=[];try{for(n=0;n<44;n++)m[n]=h(t[n])}catch(g){return}var w=new f(m);return Object(r["b"])(w.Decrypt(e.slice(0,r["h"].length)),r["h"])?w:void 0}}function h(e){var t=Object.keys(e).length;if(0===t)throw"can not match at least one key";t>1&&console.warn("There are 2 potential value for the mask!");var n="",r=0;for(var a in e)e[a]>r&&(n=a,r=e[a]);return Number(n)}function p(e){for(var t=[e,255],n=2;n<e;n++)t.push(255);return t.push(255),a.concat(t,i)}function v(e){for(var t=[6,0],n=2;n<e;n++)t.push(4);return t.push(0),c.concat(t,o)}},4:function(e,t){},5:function(e,t){},"5c0b":function(e,t,n){"use strict";n("9c0c")},6:function(e,t){},"6d95":function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return _}));n("d3b7"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("d81d"),n("fb6a"),n("ddb0"),n("25f0"),n("ac1f"),n("5319"),n("159b"),n("4de4"),n("1276"),n("498a"),n("a15b"),n("3ca3"),n("2b3d"),n("9861");var r=n("9ab4"),a=n("cc74"),i=n("cb96"),c=n("ef21"),o=n.n(c),s=n("c198"),u=n.n(s),l=n("ead9"),f=n.n(l),d=n("81bf"),b=n.n(d),m=n("17e1"),h=n.n(m),p=n("1132"),v=n.n(p),w=n("f8d5"),g=n.n(w),y=n("640f"),O=n.n(y),j=O.a.parse("687a4852416d736f356b496e62617857"),x=O.a.parse("2331346C6A6B5F215C5D2630553C2728"),k=[67,84,69,78,70,68,65,77];function _(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var n;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return n=A.bind,[4,Object(a["d"])(e)];case 1:return[2,(new(n.apply(A,[void 0,r.sent(),t]))).decrypt()]}}))}))}var A=function(){function t(e,t){this.offset=0,this.format="",this.mime="";var n=new Uint8Array(e,0,8);if(!Object(a["b"])(n,k))throw Error("此ncm文件已损坏");this.offset=10,this.raw=e,this.view=new DataView(e),this.filename=t}return t.prototype._getKeyData=function(){var e=this.view.getUint32(this.offset,!0);this.offset+=4;var t=new Uint8Array(this.raw,this.offset,e).map((function(e){return 100^e}));this.offset+=e;for(var n=u.a.decrypt({ciphertext:h.a.create(t)},j,{mode:b.a,padding:f.a}),r=new Uint8Array(n.sigBytes),a=n.words,i=n.sigBytes,c=0;c<i;c++)r[c]=a[c>>>2]>>>24-c%4*8&255;return r.slice(17)},t.prototype._getKeyBox=function(){for(var e,t=this._getKeyData(),n=new Uint8Array(Array(256).keys()),r=t.length,a=0,i=0;i<256;i++)a=n[i]+a+t[i%r]&255,e=[n[a],n[i]],n[i]=e[0],n[a]=e[1];return n.map((function(e,t,n){t=t+1&255;var r=n[t],a=n[t+r&255];return n[r+a&255]}))},t.prototype._getMetaData=function(){var e=this.view.getUint32(this.offset,!0);if(this.offset+=4,0===e)return{};var t=new Uint8Array(this.raw,this.offset,e).map((function(e){return 99^e}));this.offset+=e,h.a.create();var n,r=u.a.decrypt({ciphertext:v.a.parse(h.a.create(t.slice(22)).toString(g.a))},x,{mode:b.a,padding:f.a}).toString(g.a),a=r.indexOf(":");if("dj"===r.slice(0,a)){var i=JSON.parse(r.slice(a+1));n=i.mainMusic}else n=JSON.parse(r.slice(a+1));return n.albumPic&&(n.albumPic=n.albumPic.replace("http://","https://")+"?param=500y500"),n},t.prototype._getAudio=function(e){this.offset+=this.view.getUint32(this.offset+5,!0)+13;for(var t=new Uint8Array(this.raw,this.offset),n=t.length,r=0;r<n;++r)t[r]^=e[255&r];return t},t.prototype._buildMeta=function(){var t;return Object(r["a"])(this,void 0,void 0,(function(){var n,i,c,s,u,l;return Object(r["b"])(this,(function(r){switch(r.label){case 0:if(!this.oriMeta)throw Error("invalid sequence");if(n=Object(a["g"])(this.filename,this.oriMeta.musicName),i=[],this.oriMeta.artist&&this.oriMeta.artist.forEach((function(e){return i.push(e[0])})),0===i.length&&n.artist&&(i=n.artist.split(",").map((function(e){return e.trim()})).filter((function(e){return""!=e}))),!this.oriMeta.albumPic)return[3,9];r.label=1;case 1:return r.trys.push([1,8,,9]),c=this,[4,Object(a["f"])(this.oriMeta.albumPic)];case 2:c.image=r.sent(),r.label=3;case 3:return this.image&&this.image.buffer.byteLength>=1<<24?[4,o.a.read(e.from(this.image.buffer))]:[3,7];case 4:return s=r.sent(),[4,s.resize(Math.round(s.getHeight()/2),o.a.AUTO)];case 5:return r.sent(),u=this.image,[4,s.getBufferAsync("image/jpeg")];case 6:return u.buffer=r.sent(),[3,3];case 7:return[3,9];case 8:return l=r.sent(),console.log("get cover image failed",l),[3,9];case 9:return this.newMeta={title:n.title,artists:i,album:this.oriMeta.album,picture:null===(t=this.image)||void 0===t?void 0:t.buffer},[2]}}))}))},t.prototype._writeMeta=function(){return Object(r["a"])(this,void 0,void 0,(function(){var t,n;return Object(r["b"])(this,(function(r){switch(r.label){case 0:if(!this.audio||!this.newMeta)throw Error("invalid sequence");return this.blob||(this.blob=new Blob([this.audio],{type:this.mime})),[4,Object(i["parseBlob"])(this.blob)];case 1:if(t=r.sent(),n=!t.common.album&&!t.common.artists&&!t.common.title,n||this.newMeta.picture){if("mp3"===this.format)this.audio=Object(a["l"])(e.from(this.audio),this.newMeta,t);else{if("flac"!==this.format)return console.info("writing meta for "+this.format+" is not being supported for now"),[2];this.audio=Object(a["k"])(e.from(this.audio),this.newMeta,t)}this.blob=new Blob([this.audio],{type:this.mime})}return[2]}}))}))},t.prototype.gatherResult=function(){var e,t;if(!this.newMeta)throw Error("bad sequence");return{title:this.newMeta.title,artist:null===(e=this.newMeta.artists)||void 0===e?void 0:e.join("; "),ext:this.format,album:this.newMeta.album,picture:null===(t=this.image)||void 0===t?void 0:t.url,file:URL.createObjectURL(this.blob),blob:this.blob,mime:this.mime}},t.prototype.decrypt=function(){return Object(r["a"])(this,void 0,void 0,(function(){var e,t;return Object(r["b"])(this,(function(n){switch(n.label){case 0:return e=this._getKeyBox(),this.oriMeta=this._getMetaData(),this.audio=this._getAudio(e),this.format=this.oriMeta.format||Object(a["i"])(this.audio),this.mime=a["a"][this.format],[4,this._buildMeta()];case 1:n.sent(),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,this._writeMeta()];case 3:return n.sent(),[3,5];case 4:return t=n.sent(),console.warn("write meta data failed",t),[3,5];case 5:return[2,this.gatherResult()]}}))}))},t}()}).call(this,n("1c35").Buffer)},"6e46":function(e,t,n){"use strict";n("cfca")},"73ec":function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"a",(function(){return l}));n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("2ca0");var r,a=n("9ab4");(function(e){e[e["ArtistAndTitle"]=0]="ArtistAndTitle",e[e["TitleOnly"]=1]="TitleOnly",e[e["TitleAndArtist"]=2]="TitleAndArtist",e[e["SameAsOriginal"]=3]="SameAsOriginal"})(r||(r={}));var i=[{key:r.ArtistAndTitle,text:"歌手-歌曲名"},{key:r.TitleOnly,text:"歌曲名"},{key:r.TitleAndArtist,text:"歌曲名-歌手"},{key:r.SameAsOriginal,text:"同源文件名"}];function c(e,t){switch(t){case r.TitleOnly:return e.title+"."+e.ext;case r.TitleAndArtist:return e.title+" - "+e.artist+"."+e.ext;case r.SameAsOriginal:return e.rawFilename+"."+e.ext;default:case r.ArtistAndTitle:return e.artist+" - "+e.title+"."+e.ext}}function o(e,t,n){return Object(a["a"])(this,void 0,void 0,(function(){var r,i,o;return Object(a["b"])(this,(function(a){switch(a.label){case 0:r=c(e,t),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.getFileHandle(r)];case 2:return a.sent(),r=(new Date).getTime()+" - "+r,[3,4];case 3:return a.sent(),[3,4];case 4:return[4,n.getFileHandle(r,{create:!0})];case 5:return i=a.sent(),[4,i.createWritable()];case 6:return o=a.sent(),[4,o.write(e.blob)];case 7:return a.sent(),[4,o.close()];case 8:return a.sent(),[2]}}))}))}function s(e,t){var n=document.createElement("a");n.href=e.file,n.download=c(e,t),document.body.append(n),n.click(),n.remove()}function u(e){var t;URL.revokeObjectURL(e.file),(null===(t=e.picture)||void 0===t?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.picture)}var l=function(){function e(){this.pending=[]}return e.prototype.queue=function(e){this.pending.push(e),this.consume()},e.prototype.consume=function(){var e=this,t=this.pending.shift();t&&t().then((function(){return e.consume})).catch(console.error)},e}()},8850:function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return d}));n("d3b7"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("fb6a"),n("ac1f"),n("1276"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861");var r=n("9ab4"),a=n("3349"),i=n("1fb5"),c=n("cc74"),o=n("cb96"),s=n("acf9"),u=n.n(s),l=n("97e5"),f={mgg:{handler:a["c"],ext:"ogg",detect:!0},mflac:{handler:a["b"],ext:"flac",detect:!0},"mgg.cache":{handler:a["c"],ext:"ogg",detect:!1},"mflac.cache":{handler:a["b"],ext:"flac",detect:!1},qmc0:{handler:a["d"],ext:"mp3",detect:!1},qmc2:{handler:a["d"],ext:"ogg",detect:!1},qmc3:{handler:a["d"],ext:"mp3",detect:!1},qmcogg:{handler:a["d"],ext:"ogg",detect:!1},qmcflac:{handler:a["d"],ext:"flac",detect:!1},bkcmp3:{handler:a["d"],ext:"mp3",detect:!1},bkcflac:{handler:a["d"],ext:"flac",detect:!1},tkm:{handler:a["d"],ext:"m4a",detect:!1},"666c6163":{handler:a["d"],ext:"flac",detect:!1},"6d7033":{handler:a["d"],ext:"mp3",detect:!1},"6f6767":{handler:a["d"],ext:"ogg",detect:!1},"6d3461":{handler:a["d"],ext:"m4a",detect:!1},776176:{handler:a["d"],ext:"wav",detect:!1}};function d(t,n,a){var i,s,d,h;return Object(r["a"])(this,void 0,Promise,(function(){var p,v,w,g,y,O,j,x,k,_,A,T,U,P,M,D,E,B;return Object(r["b"])(this,(function(r){switch(r.label){case 0:if(!(a in f))throw"Qmc cannot handle type: "+a;return p=f[a],w=Uint8Array.bind,[4,Object(c["d"])(t)];case 1:return v=new(w.apply(Uint8Array,[void 0,r.sent()])),p.detect?(j=new DataView(v.slice(v.length-4).buffer).getUint32(0,!0),x=v.length-4-j,g=v.slice(0,x),y=p.handler(g),O=v.slice(x,x+j),y?[3,3]:[4,b(O,n,a)]):[3,4];case 2:y=r.sent(),r.label=3;case 3:if(!y)throw a+"格式仅提供实验性支持";return[3,5];case 4:if(g=v,y=p.handler(g),!y)throw a+"格式仅提供实验性支持";r.label=5;case 5:return k=y.Decrypt(g),_=Object(c["i"])(k,p.ext),A=c["a"][_],T=new Blob([k],{type:A}),[4,Object(o["parseBlob"])(T)];case 6:for(P in U=r.sent(),U.native)U.native.hasOwnProperty(P)&&U.native[P].some((function(e){return"TCON"===e.id&&"(12)"===e.value}))&&(console.warn("try using gbk encoding to decode meta"),U.common.artist=u.a.decode(new e(null!==(i=U.common.artist)&&void 0!==i?i:""),"gbk"),U.common.title=u.a.decode(new e(null!==(s=U.common.title)&&void 0!==s?s:""),"gbk"),U.common.album=u.a.decode(new e(null!==(d=U.common.album)&&void 0!==d?d:""),"gbk"));return M=Object(c["g"])(n,U.common.title,U.common.artist),O&&Object(l["d"])(O,y.getMatrix128(),n,a,M.title,M.artist,U.common.album).then().catch(),D=Object(c["e"])(U),D?[3,9]:[4,m(M.title,M.artist,U.common.album)];case 7:return D=r.sent(),D?[4,Object(c["f"])(D)]:[3,9];case 8:if(E=r.sent(),E){D=E.url;try{B={picture:E.buffer,title:M.title,artists:null===(h=M.artist)||void 0===h?void 0:h.split(" _ ")},"mp3"===_?(k=Object(c["l"])(e.from(k),B,U),T=new Blob([k],{type:A})):"flac"===_?(k=Object(c["k"])(e.from(k),B,U),T=new Blob([k],{type:A})):console.info("writing metadata for "+_+" is not being supported for now")}catch(S){console.warn("Error while appending cover image to file "+S)}}r.label=9;case 9:return[2,{title:M.title,artist:M.artist,ext:_,album:U.common.album,picture:D,file:URL.createObjectURL(T),blob:T,mime:A}]}}))}))}function b(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var c,o;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,Object(l["c"])(e,t,n)];case 1:return c=r.sent(),[2,new a["a"](Object(i["toByteArray"])(c.Matrix44))];case 2:return o=r.sent(),console.warn(o),[3,3];case 3:return[2]}}))}))}function m(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var a,i,c;return Object(r["b"])(this,(function(r){switch(r.label){case 0:a="https://stats.ixarea.com/apis/music/qq-cover",r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(l["b"])(e,t,n)];case 2:return i=r.sent(),[2,a+"/"+i.Type+"/"+i.Id];case 3:return c=r.sent(),console.warn(c),[3,4];case 4:return[2,""]}}))}))}}).call(this,n("1c35").Buffer)},9224:function(e){e.exports=JSON.parse('{"name":"unlock-music","version":"v1.9.1","updateInfo":"新增写入本地文件系统; 优化.kwm解锁; 支持.acc嗅探; 使用Typescript重构","license":"MIT","description":"Unlock encrypted music file in browser.","repository":{"type":"git","url":"https://github.com/ix64/unlock-music"},"private":true,"scripts":{"serve":"vue-cli-service serve","build":"vue-cli-service build","fix-compatibility":"node ./src/fix-compatibility.js","make-extension":"node ./make-extension.js"},"dependencies":{"base64-js":"^1.5.1","browser-id3-writer":"^4.4.0","core-js":"^3.16.0","crypto-js":"^4.1.1","element-ui":"^2.15.5","iconv-lite":"^0.6.3","jimp":"^0.16.1","metaflac-js":"^1.0.5","music-metadata":"7.9.0","music-metadata-browser":"2.2.7","register-service-worker":"^1.7.2","threads":"^1.6.5","vue":"^2.6.14"},"devDependencies":{"@types/crypto-js":"^4.0.2","@vue/cli-plugin-babel":"^4.5.13","@vue/cli-plugin-pwa":"^4.5.13","@vue/cli-plugin-typescript":"^4.5.13","@vue/cli-service":"^4.5.13","babel-plugin-component":"^1.1.1","sass":"^1.38.1","sass-loader":"^10.2.0","semver":"^7.3.5","threads-plugin":"^1.4.0","typescript":"~4.1.6","vue-cli-plugin-element":"^1.0.1","vue-template-compiler":"^2.6.14"}}')},"92c5":function(e,t,n){"use strict";n("29c8")},"97e5":function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return u}));n("d3b7"),n("e9c4"),n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("3ca3"),n("ddb0"),n("9861"),n("25f0");var r=n("9ab4"),a=n("1fb5"),i="https://um-api.ixarea.com";function c(e){return Object(r["a"])(this,void 0,Promise,(function(){var t;return Object(r["b"])(this,(function(n){switch(n.label){case 0:return[4,fetch(i+"/music/app-version",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Version:e})})];case 1:return t=n.sent(),[4,t.json()];case 2:return[2,n.sent()]}}))}))}function o(e,t,n,r,c,o,s){return fetch(i+"/qmcmask/usage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Mask:Object(a["fromByteArray"])(new Uint8Array(t)),Key:Object(a["fromByteArray"])(e),Artist:o,Title:c,Album:s,Filename:n,Format:r})})}function s(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var c;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return[4,fetch(i+"/qmcmask/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({Format:n,Key:Object(a["fromByteArray"])(e),Filename:t,Type:44})})];case 1:return c=r.sent(),[4,c.json()];case 2:return[2,r.sent()]}}))}))}function u(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var a,c,o;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return a=i+"/music/qq-cover",c=new URLSearchParams([["Title",e],["Artist",null!==t&&void 0!==t?t:""],["Album",null!==n&&void 0!==n?n:""]]),[4,fetch(a+"?"+c.toString())];case 1:return o=r.sent(),[4,o.json()];case 2:return[2,r.sent()]}}))}))}},"9c0c":function(e,t,n){},cc74:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return v})),n.d(t,"i",(function(){return w})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return O})),n.d(t,"f",(function(){return j})),n.d(t,"l",(function(){return x})),n.d(t,"k",(function(){return k})),n.d(t,"j",(function(){return _}));n("d3b7"),n("fb6a"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("ac1f"),n("1276"),n("498a"),n("2ca0"),n("159b");var r=n("9ab4"),a=n("7907"),i=n.n(a),c=n("b686"),o=n.n(c),s=[102,76,97,67],u=[73,68,51],l=[79,103,103,83],f=[102,116,121,112],d=[48,38,178,117,142,102,207,17,166,217,0,170,0,98,206,108],b=[82,73,70,70],m=[255,241],h=[70,82,77,56],p={mp3:"audio/mpeg",flac:"audio/flac",m4a:"audio/mp4",ogg:"audio/ogg",wma:"audio/x-ms-wma",wav:"audio/x-wav",dff:"audio/x-dff"};function v(e,t){return!(t.length>e.length)&&t.every((function(t,n){return t===e[n]}))}function w(e,t){return void 0===t&&(t="mp3"),v(e,u)?"mp3":v(e,s)?"flac":v(e,l)?"ogg":e.length>=4+f.length&&v(e.slice(4),f)?"m4a":v(e,b)?"wav":v(e,d)?"wma":v(e,m)?"aac":v(e,h)?"dff":t}function g(e){return e.arrayBuffer?e.arrayBuffer():new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var r,a=null===(r=e.target)||void 0===r?void 0:r.result;a?t(a):n("read file failed")},r.readAsArrayBuffer(e)}))}function y(e){var t;return(null===(t=e.common)||void 0===t?void 0:t.picture)&&e.common.picture.length>0?URL.createObjectURL(new Blob([e.common.picture[0].data],{type:e.common.picture[0].format})):""}function O(e,t,n,r){void 0===r&&(r="-");var a={title:null!==t&&void 0!==t?t:"",artist:n},i=e.split(r);return i.length>1?(a.artist||(a.artist=i[0].trim()),a.title||(a.title=i[1].trim())):1===i.length&&(a.title||(a.title=i[0].trim())),a}function j(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,a,i,c;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),[4,fetch(e)];case 1:return t=r.sent(),n=t.headers.get("Content-Type"),(null===n||void 0===n?void 0:n.startsWith("image/"))?[4,t.arrayBuffer()]:[3,3];case 2:return a=r.sent(),i=URL.createObjectURL(new Blob([a],{type:n})),[2,{buffer:a,url:i,mime:n}];case 3:return[3,5];case 4:return c=r.sent(),console.warn(c),[3,5];case 5:return[2]}}))}))}function x(e,t,n){var r=new i.a(e),a=n.native["ID3v2.4"]||n.native["ID3v2.3"]||n.native["ID3v2.2"]||[];a.forEach((function(e){if("TPE1"!==e.id&&"TIT2"!==e.id&&"TALB"!==e.id)try{r.setFrame(e.id,e.value)}catch(t){}}));var c=n.common;return r.setFrame("TPE1",(null===c||void 0===c?void 0:c.artists)||t.artists||[]).setFrame("TIT2",(null===c||void 0===c?void 0:c.title)||t.title).setFrame("TALB",(null===c||void 0===c?void 0:c.album)||t.album||""),t.picture&&r.setFrame("APIC",{type:3,data:t.picture,description:t.picture_desc||"Cover"}),r.addTag()}function k(t,n,r){var a=new o.a(t),i=r.common;return i.title||i.album||!i.artists||(a.setTag("TITLE="+n.title),a.setTag("ALBUM="+n.album),n.artists&&(a.removeTag("ARTIST"),n.artists.forEach((function(e){return a.setTag("ARTIST="+e)})))),n.picture&&a.importPictureFromBuffer(e.from(n.picture)),a.save()}function _(e){var t=e.lastIndexOf(".");return{ext:e.substring(t+1).toLowerCase(),name:e.substring(0,t)}}}).call(this,n("1c35").Buffer)},cd49:function(e,t,n){"use strict";n.r(t);n("9e1f"),n("450d");var r=n("6ed5"),a=n.n(r),i=(n("46a1"),n("e5f2")),c=n.n(i),o=(n("6b30"),n("c284")),s=n.n(o),u=(n("0c67"),n("299c")),l=n.n(u),f=(n("b5d8"),n("f494")),d=n.n(f),b=(n("560b"),n("dcdc")),m=n.n(b),h=(n("f225"),n("89a9")),p=n.n(h),v=(n("f4f9"),n("c2cc")),w=n.n(v),g=(n("7a0f"),n("0f6c")),y=n.n(g),O=(n("aaa5"),n("a578")),j=n.n(O),x=(n("adec"),n("3d2d")),k=n.n(x),_=(n("bdc7"),n("aa2f")),A=n.n(_),T=(n("de31"),n("c69e")),U=n.n(T),P=(n("5466"),n("ecdf")),M=n.n(P),D=(n("38a0"),n("ad41")),E=n.n(D),B=(n("1951"),n("eedf")),S=n.n(B),R=(n("acb6"),n("c673")),F=n.n(R),L=(n("fd71"),n("a447")),q=n.n(L),C=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("2b0e")),$=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.isMobile?n("Mobile"):n("el-container",{attrs:{id:"app"}},[n("el-main",[n("Home")],1),n("el-footer",[n("el-row",[e._v(" 目前支持网易云音乐(ncm), QQ音乐(qmc, mflac, mgg), 酷狗音乐(kgm), 虾米音乐(xm), 酷我音乐(.kwm) "),n("a",{attrs:{href:"https://github.com/ix64/unlock-music/blob/master/README.md",target:"_blank"}},[e._v("更多")]),e._v("。 ")])],1)],1)},I=[],N=n("1da1"),H=(n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-upload",{attrs:{"auto-upload":!1,"on-change":e.addFile,"show-file-list":!1,action:"",drag:"",multiple:""}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),n("em",[e._v("点击选择")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[n("div",[e._v(" 仅在浏览器内对文件进行解锁，无需消耗流量 "),n("el-tooltip",{attrs:{effect:"dark",placement:"top-start"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v(" 算法在源代码中已经提供，所有运算都发生在本地 ")]),n("i",{staticClass:"el-icon-info",staticStyle:{"font-size":"12px"}})])],1)]),n("transition",{attrs:{name:"el-fade-in"}},[n("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.progress_show,expression:"progress_show"}],staticStyle:{margin:"16px 6px 0 6px"},attrs:{format:e.progress_string,percentage:e.progress_value,"stroke-width":16,"text-inside":!0}})],1)],1)}),J=[],z=n("0565"),K=z["a"],V=n("2877"),Q=Object(V["a"])(K,H,J,!1,null,null,null),W=Q.exports,G=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[n("el-table-column",{attrs:{label:"封面",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-image",{staticStyle:{width:"60px",height:"60px"},attrs:{src:t.row.picture}},[n("div",{staticClass:"image-slot el-image__error",attrs:{slot:"error"},slot:"error"},[e._v(" 暂无封面 ")])])]}}])}),n("el-table-column",{attrs:{label:"歌曲"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.title))])]}}])}),n("el-table-column",{attrs:{label:"操作",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-video-play",type:"success"},on:{click:function(n){return e.handlePlay(t.$index,t.row)}}}),n("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-download"},on:{click:function(n){return e.handleDownload(t.row)}}}),n("el-button",{attrs:{size:"mini",circle:"",icon:"el-icon-delete",type:"danger"},on:{click:function(n){return e.handleDelete(t.$index,t.row)}}})]}}])})],1)},X=[],Y=(n("a9e3"),n("a434"),n("73ec")),Z={name:"PreviewTable",props:{tableData:{type:Array,required:!0},policy:{type:Number,required:!0}},methods:{handlePlay:function(e,t){this.$emit("play",t.file)},handleDelete:function(e,t){Object(Y["f"])(t),this.tableData.splice(e,1)},handleDownload:function(e){this.$emit("download",e)}}},ee=Z,te=(n("92c5"),Object(V["a"])(ee,G,X,!1,null,"02c00ce9",null)),ne=te.exports,re=n("9224"),ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("file-selector",{on:{error:e.showFail,success:e.showSuccess}}),n("div",{attrs:{id:"app-control"}},[n("el-row",{staticClass:"mb-3"},[n("span",[e._v("歌曲命名格式：")]),e._l(e.FilenamePolicies,(function(t){return n("el-radio",{key:t.key,attrs:{label:t.key},model:{value:e.filename_policy,callback:function(t){e.filename_policy=t},expression:"filename_policy"}},[e._v(" "+e._s(t.text)+" ")])}))],2),n("el-row",[n("el-button",{attrs:{icon:"el-icon-download",plain:""},on:{click:e.handleDownloadAll}},[e._v("下载全部")]),n("el-button",{attrs:{icon:"el-icon-delete",plain:"",type:"danger"},on:{click:e.handleDeleteAll}},[e._v("清除全部")]),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"top-start"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e.instant_save?n("span",[e._v("工作模式: "+e._s(e.dir?"写入本地文件系统":"调用浏览器下载"))]):n("span",[e._v(" 当您使用此工具进行大量文件解锁的时候，建议开启此选项。"),n("br"),e._v(" 开启后，解锁结果将不会存留于浏览器中，防止内存不足。 ")])]),n("el-checkbox",{staticClass:"ml-2",attrs:{border:""},model:{value:e.instant_save,callback:function(t){e.instant_save=t},expression:"instant_save"}},[e._v("立即保存")])],1)],1)],1),n("audio",{attrs:{autoplay:e.playing_auto,src:e.playing_url,controls:""}}),n("PreviewTable",{attrs:{policy:e.filename_policy,"table-data":e.tableData},on:{download:e.saveFile,play:e.changePlaying}})],1)},ie=[],ce=(n("e9c4"),n("d3b7"),n("159b"),{name:"Home",components:{FileSelector:W,PreviewTable:ne},data:function(){return{tableData:[],playing_url:"",playing_auto:!1,filename_policy:Y["e"].ArtistAndTitle,instant_save:!1,FilenamePolicies:Y["d"],dir:null}},watch:{instant_save:function(e){e&&this.showDirectlySave()}},methods:{showSuccess:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.instant_save){n.next=6;break}return n.next=3,t.saveFile(e);case 3:Object(Y["f"])(e),n.next=8;break;case 6:t.tableData.push(e),t.$notify.success({title:"解锁成功",message:"成功解锁 "+e.title,duration:3e3});case 8:r=[e.title,e.artist,e.album],window._paq.push(["trackEvent","Unlock",e.rawExt+","+e.mime,JSON.stringify(r)]);case 9:case"end":return n.stop()}}),n)})))()},showFail:function(e,t){console.error(e,t),this.$notify.error({title:"出现问题",message:e+"，"+t+'，参考<a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:6e3}),window._paq.push(["trackEvent","Error",String(e),t])},changePlaying:function(e){this.playing_url=e,this.playing_auto=!0},handleDeleteAll:function(){this.tableData.forEach((function(e){Object(Y["f"])(e)})),this.tableData=[]},handleDownloadAll:function(){var e=this,t=0,n=setInterval((function(){t<e.tableData.length?(e.saveFile(e.tableData[t]),t++):clearInterval(n)}),300)},saveFile:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.dir){n.next=6;break}return n.next=3,Object(Y["b"])(e,t.filename_policy,t.dir);case 3:t.$notify({title:"保存成功",message:e.title,position:"top-left",type:"success",duration:3e3}),n.next=7;break;case 6:Object(Y["c"])(e,t.filename_policy);case 7:case"end":return n.stop()}}),n)})))()},showDirectlySave:function(){var e=this;return Object(N["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.showDirectoryPicker){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.$confirm("您的浏览器支持文件直接保存到磁盘，是否使用？","新特性提示",{confirmButtonText:"使用",cancelButtonText:"不使用",type:"warning",center:!0});case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t["catch"](2),console.log(t.t0),t.abrupt("return");case 11:return t.prev=11,t.next=14,window.showDirectoryPicker();case 14:return e.dir=t.sent,n="__unlock_music_write_test.txt",t.next=18,e.dir.getFileHandle(n,{create:!0});case 18:return t.next=20,e.dir.removeEntry(n);case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](11),console.error(t.t1);case 25:case"end":return t.stop()}}),t,null,[[2,7],[11,22]])})))()}}}),oe=ce,se=Object(V["a"])(oe,ae,ie,!1,null,null,null),ue=se.exports,le=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"mobile"},[n("file-selector",{on:{error:e.showFail,success:e.showSuccess}}),n("div",{attrs:{id:"app-control"}},[n("el-row",[n("span",[e._v("歌曲命名格式：")])]),n("el-row",e._l(e.FilenamePolicies,(function(t){return n("el-radio",{key:t.key,attrs:{label:t.key},model:{value:e.filename_policy,callback:function(t){e.filename_policy=t},expression:"filename_policy"}},[e._v(" "+e._s(t.text)+" ")])})),1),n("el-row",[n("el-button",{attrs:{size:"mini",icon:"el-icon-download",plain:""},on:{click:e.handleDownloadAll}},[e._v("下载全部")]),n("el-button",{attrs:{size:"mini",icon:"el-icon-delete",plain:"",type:"danger"},on:{click:e.handleDeleteAll}},[e._v("清除全部")])],1)],1),n("audio",{attrs:{autoplay:e.playing_auto,src:e.playing_url,controls:""}}),n("PreviewTable",{attrs:{policy:e.filename_policy,"table-data":e.tableData},on:{download:e.saveFile,play:e.changePlaying}})],1)},fe=[],de={name:"mobile",components:{FileSelector:W,PreviewTable:ne},data:function(){return{tableData:[],playing_url:"",playing_auto:!1,filename_policy:Y["e"].ArtistAndTitle,instant_save:!1,FilenamePolicies:Y["d"],dir:null}},watch:{instant_save:function(e){e&&this.showDirectlySave()}},methods:{showSuccess:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.instant_save){n.next=6;break}return n.next=3,t.saveFile(e);case 3:Object(Y["f"])(e),n.next=8;break;case 6:t.tableData.push(e),t.$notify.success({title:"解锁成功",message:"成功解锁 "+e.title,duration:3e3});case 8:r=[e.title,e.artist,e.album],window._paq.push(["trackEvent","Unlock",e.rawExt+","+e.mime,JSON.stringify(r)]);case 9:case"end":return n.stop()}}),n)})))()},showFail:function(e,t){console.error(e,t),this.$notify.error({title:"出现问题",message:e+"，"+t+'，参考<a target="_blank" href="https://github.com/ix64/unlock-music/wiki/使用提示">使用提示</a>',dangerouslyUseHTMLString:!0,duration:6e3}),window._paq.push(["trackEvent","Error",String(e),t])},changePlaying:function(e){this.playing_url=e,this.playing_auto=!0},handleDeleteAll:function(){this.tableData.forEach((function(e){Object(Y["f"])(e)})),this.tableData=[]},handleDownloadAll:function(){var e=this,t=0,n=setInterval((function(){t<e.tableData.length?(e.saveFile(e.tableData[t]),t++):clearInterval(n)}),300)},saveFile:function(e){var t=this;return Object(N["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!t.dir){n.next=6;break}return n.next=3,Object(Y["b"])(e,t.filename_policy,t.dir);case 3:t.$notify({title:"保存成功",message:e.title,position:"top-left",type:"success",duration:3e3}),n.next=7;break;case 6:Object(Y["c"])(e,t.filename_policy);case 7:case"end":return n.stop()}}),n)})))()},showDirectlySave:function(){var e=this;return Object(N["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.showDirectoryPicker){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.next=5,e.$confirm("您的浏览器支持文件直接保存到磁盘，是否使用？","新特性提示",{confirmButtonText:"使用",cancelButtonText:"不使用",type:"warning",center:!0});case 5:t.next=11;break;case 7:return t.prev=7,t.t0=t["catch"](2),console.log(t.t0),t.abrupt("return");case 11:return t.prev=11,t.next=14,window.showDirectoryPicker();case 14:return e.dir=t.sent,n="__unlock_music_write_test.txt",t.next=18,e.dir.getFileHandle(n,{create:!0});case 18:return t.next=20,e.dir.removeEntry(n);case 20:t.next=25;break;case 22:t.prev=22,t.t1=t["catch"](11),console.error(t.t1);case 25:case"end":return t.stop()}}),t,null,[[2,7],[11,22]])})))()}}},be=de,me=(n("6e46"),Object(V["a"])(be,le,fe,!1,null,"05da7fdd",null)),he=me.exports,pe=n("97e5"),ve={name:"app",components:{FileSelector:W,PreviewTable:ne,Home:ue,Mobile:he},data:function(){return{version:re.version,isMobile:!0}},created:function(){var e=this;this.$nextTick((function(){return e.finishLoad()}))},methods:{finishLoad:function(){var e=this;return Object(N["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=document.getElementById("loader-mask"),n&&n.remove(),t.prev=2,t.next=5,Object(pe["a"])(e.version);case 5:t.sent,t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](2),console.warn("check version info failed",t.t0);case 11:case"end":return t.stop()}}),t,null,[[2,8]])})))()}}},we=ve,ge=(n("5c0b"),Object(V["a"])(we,$,I,!1,null,null,null)),ye=ge.exports,Oe=n("9483");"https:"===window.location.protocol&&Object(Oe["a"])("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available."),window.location.reload()},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),C["default"].use(q.a),C["default"].use(F.a),C["default"].use(S.a),C["default"].use(E.a),C["default"].use(M.a),C["default"].use(U.a),C["default"].use(A.a),C["default"].use(k.a),C["default"].use(j.a),C["default"].use(y.a),C["default"].use(w.a),C["default"].use(p.a),C["default"].use(m.a),C["default"].use(d.a),C["default"].use(l.a),C["default"].use(s.a),C["default"].prototype.$notify=c.a,C["default"].prototype.$confirm=a.a.confirm,C["default"].config.productionTip=!1,new C["default"]({render:function(e){return e(ye)}}).$mount("#app")},cfca:function(e,t,n){},eaa5:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));n("d3b7"),n("b0c0");var r=n("9ab4"),a=n("6d95"),i=(n("ace4"),n("5cc6"),n("907a"),n("9a8c"),n("a975"),n("735e"),n("c1ac"),n("d139"),n("3a7b"),n("d5d6"),n("82f8"),n("e91f"),n("60bd"),n("5f96"),n("3280"),n("3fcc"),n("ca91"),n("25a1"),n("cd26"),n("3c5d"),n("2954"),n("649e"),n("219c"),n("170b"),n("b39a"),n("72f7"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("cc74")),c=n("cb96");function o(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var a,o,s,u,l,f,d,b,m;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return o=Uint8Array.bind,[4,Object(i["d"])(e)];case 1:for(a=new(o.apply(Uint8Array,[void 0,r.sent()])),s=a.length,u=0;u<s;u++)a[u]^=163;return l=Object(i["i"])(a,n),l!==n&&(e=new Blob([a],{type:i["a"][l]})),[4,Object(c["parseBlob"])(e)];case 2:return f=r.sent(),d=Object(i["g"])(t,f.common.title,f.common.artist),b=d.title,m=d.artist,[2,{title:b,artist:m,ext:l,album:f.common.album,picture:Object(i["e"])(f),file:URL.createObjectURL(e),blob:e,mime:i["a"][l]}]}}))}))}n("fb6a");function s(e,t,n,a){return void 0===a&&(a=!0),Object(r["a"])(this,void 0,Promise,(function(){var o,s,u,l,f,d,b;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return o=n,a?(u=Uint8Array.bind,[4,Object(i["d"])(e)]):[3,2];case 1:s=new(u.apply(Uint8Array,[void 0,r.sent()])),o=Object(i["i"])(s,n),o!==n&&(e=new Blob([s],{type:i["a"][o]})),r.label=2;case 2:return[4,Object(c["parseBlob"])(e)];case 3:return l=r.sent(),f=Object(i["g"])(t,l.common.title,l.common.artist),d=f.title,b=f.artist,[2,{title:d,artist:b,ext:o,album:l.common.album,picture:Object(i["e"])(l),file:URL.createObjectURL(e),blob:e,mime:i["a"][o]}]}}))}))}var u=[105,102,109,116],l=[254,254,254,254],f={" WAV":".wav",FLAC:".flac"," MP3":".mp3"," A4M":".m4a"};function d(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var a,o,d,b,m,h,p,v,w,g,y,O,j,x,k;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return o=Uint8Array.bind,[4,Object(i["d"])(e)];case 1:if(a=new(o.apply(Uint8Array,[void 0,r.sent()])),Object(i["b"])(a,u)&&Object(i["b"])(a.slice(8,12),l))return[3,4];if("xm"!==n)return[3,2];throw Error("此xm文件已损坏");case 2:return[4,s(e,t,n,!0)];case 3:return[2,r.sent()];case 4:if(d=(new TextDecoder).decode(a.slice(4,8)),!f.hasOwnProperty(d))throw Error("未知的.xm文件类型");for(b=a[15],m=a[12]|a[13]<<8|a[14]<<16,h=a.slice(16),p=h.length,v=m;v<p;++v)h[v]=h[v]-b^255;return w=f[d],g=i["a"][w],y=new Blob([h],{type:g}),[4,Object(c["parseBlob"])(y)];case 5:return O=r.sent(),"wav"===w&&(console.info(O.common),O.common.album="",O.common.artist="",O.common.title=""),j=Object(i["g"])(t,O.common.title,O.common.artist,-1===t.indexOf("_")?"-":"_"),x=j.title,k=j.artist,[2,{title:x,artist:k,ext:w,mime:g,album:O.common.album,picture:Object(i["e"])(O),file:URL.createObjectURL(y),blob:y,rawExt:"xm"}]}}))}))}var b=n("8850");function m(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var n,a,o,s,u,l,f,d,m,h,p;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return a=Uint8Array.bind,[4,Object(i["d"])(e)];case 1:for(n=new(a.apply(Uint8Array,[void 0,r.sent()])),o=n.length,s=0;s<o;s++)n[s]^=244,n[s]<=63?n[s]=4*n[s]:n[s]<=127?n[s]=4*(n[s]-64)+1:n[s]<=191?n[s]=4*(n[s]-128)+2:n[s]=4*(n[s]-192)+3;if(u=Object(i["i"])(n,""),l=Object(i["j"])(t),""===u&&"mp3"!==l.ext){if(l.ext in b["b"])return f=new Blob([n],{type:"application/octet-stream"}),[2,Object(b["a"])(f,l.name,l.ext)];throw"不支持的QQ音乐缓存格式"}return f=new Blob([n],{type:i["a"][u]}),[4,Object(c["parseBlob"])(f)];case 2:return d=r.sent(),m=Object(i["g"])(t,d.common.title,d.common.artist),h=m.title,p=m.artist,[2,{title:h,artist:p,ext:u,album:d.common.album,picture:Object(i["e"])(d),file:URL.createObjectURL(f),blob:f,mime:i["a"][u]}]}}))}))}var h=n("9224"),p=[5,40,188,150,233,228,90,67,145,170,189,208,122,245,54,49],v=[124,213,50,235,134,2,127,75,168,175,166,142,15,255,153,20],w=[37,223,232,166,117,30,117,14,47,128,243,45,184,182,227,17,0];function g(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var a,o,s,u,l,f,d,b,m,h,g,x,k,_,A,T,U;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return o=Uint8Array.bind,[4,Object(i["d"])(e)];case 1:if(a=new(o.apply(Uint8Array,[void 0,r.sent()])),"vpr"===n){if(!Object(i["b"])(a,p))throw Error("Not a valid vpr file!")}else if(!Object(i["b"])(a,v))throw Error("Not a valid kgm(a) file!");if(s=new DataView(a.slice(16,20).buffer),u=s.getUint32(0,!0),l=a.slice(u),f=l.length,l.byteLength>1<<26)throw Error("文件过大，请使用 <a target='_blank' href='https://github.com/unlock-music/cli'>CLI版本</a> 进行解锁");return d=new Uint8Array(17),d.set(a.slice(28,44),0),0!==O.length?[3,3]:[4,j()];case 2:if(!r.sent())throw Error("加载Kgm/Vpr Mask数据失败");r.label=3;case 3:for(h=0;h<f;h++)b=d[h%17]^l[h],b^=(15&b)<<4,m=y(h),m^=(15&m)<<4,l[h]=b^m;if("vpr"===n)for(h=0;h<f;h++)l[h]^=w[h%17];return g=Object(i["i"])(l),x=i["a"][g],k=new Blob([l],{type:x}),[4,Object(c["parseBlob"])(k)];case 4:return _=r.sent(),A=Object(i["g"])(t,_.common.title,_.common.artist),T=A.title,U=A.artist,[2,{album:_.common.album,picture:Object(i["e"])(_),file:URL.createObjectURL(k),blob:k,ext:g,mime:x,title:T,artist:U}]}}))}))}function y(e){return x[e%272]^O[e>>4]}var O=new Uint8Array(0);function j(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,a;return Object(r["b"])(this,(function(r){switch(r.label){case 0:e="https://cdn.jsdelivr.net/gh/unlock-music/unlock-music@"+h.version+"/public/static/kgm.mask",["http:","https:"].some((function(e){return e==self.location.protocol}))&&(e=self.document?"./static/kgm.mask":"../static/kgm.mask"),r.label=1;case 1:return r.trys.push([1,4,,5]),[4,fetch(e,{method:"GET"})];case 2:return t=r.sent(),n=Uint8Array.bind,[4,t.arrayBuffer()];case 3:return O=new(n.apply(Uint8Array,[void 0,r.sent()])),[2,!0];case 4:return a=r.sent(),console.error(a),[2,!1];case 5:return[2]}}))}))}var x=[184,213,61,178,233,175,120,140,131,51,113,81,118,160,205,55,47,62,53,141,169,190,152,183,231,140,34,206,90,97,223,104,105,137,254,165,182,222,169,119,252,200,189,189,229,109,62,90,54,239,105,78,190,225,233,102,28,243,217,2,182,242,18,155,68,208,111,185,53,137,182,70,109,115,130,6,105,193,237,215,133,194,48,223,162,98,190,121,45,98,98,61,13,126,190,72,137,35,2,160,228,213,117,81,50,2,83,253,22,58,33,59,22,15,195,178,187,179,226,186,58,61,19,236,246,1,69,132,165,112,15,147,73,12,100,205,49,213,204,76,7,1,158,0,26,35,144,191,136,30,59,171,166,62,196,115,71,16,126,59,94,188,227,0,132,255,9,212,224,137,15,91,88,112,79,251,101,216,92,83,27,211,200,198,191,239,152,176,80,79,15,234,229,131,88,140,40,44,132,103,205,208,158,71,219,39,80,202,244,99,99,232,151,127,27,75,12,194,193,33,76,204,88,245,148,82,163,243,211,224,104,244,0,35,243,94,10,123,147,221,171,18,178,19,232,132,215,167,159,15,50,76,85,29,4,54,82,220,3,243,249,78,66,233,61,97,239,124,182,179,147,80],k=(n("25f0"),n("843c"),[121,101,101,108,105,111,110,45,107,117,119,111,45,116,109,101]),_="MoOtOiTvINGwd2E6n0E1i7L5t2IoOoNk";function A(e,t,n){return Object(r["a"])(this,void 0,Promise,(function(){var n,a,o,u,l,f,d,b,m,h,p,v,w,g;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return a=Uint8Array.bind,[4,Object(i["d"])(e)];case 1:return n=new(a.apply(Uint8Array,[void 0,r.sent()])),Object(i["b"])(n,k)?[3,4]:"aac"!==Object(i["i"])(n)?[3,3]:[4,s(e,t,"aac",!1)];case 2:return[2,r.sent()];case 3:throw Error("not a valid kwm file");case 4:for(o=n.slice(24,32),u=T(o),l=n.slice(1024),f=l.length,d=0;d<f;++d)l[d]^=u[d%32];return b=Object(i["i"])(l),m=i["a"][b],h=new Blob([l],{type:m}),[4,Object(c["parseBlob"])(h)];case 5:return p=r.sent(),v=Object(i["g"])(t,p.common.title,p.common.artist),w=v.title,g=v.artist,[2,{album:p.common.album,picture:Object(i["e"])(p),file:URL.createObjectURL(h),blob:h,mime:m,title:w,artist:g,ext:b}]}}))}))}function T(e){for(var t=new DataView(e.buffer),n=t.getBigUint64(0,!0).toString(),r=U(n),a=new Uint8Array(32),i=0;i<32;i++)a[i]=_.charCodeAt(i)^r.charCodeAt(i);return a}function U(e){var t=e.length,n=e;return t>32?n=e.slice(0,32):t<32&&(n=e.padEnd(32,e)),n}var P=[0,0,0,32,102,116,121,112];function M(e,t){return Object(r["a"])(this,void 0,Promise,(function(){var n,a,c,o;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return a=Uint8Array.bind,[4,Object(i["d"])(e)];case 1:for(n=new(a.apply(Uint8Array,[void 0,r.sent()])),c=0;c<8;++c)n[c]=P[c];return o=new Blob([n],{type:"audio/mp4"}),[4,s(o,t,"m4a",!1)];case 2:return[2,r.sent()]}}))}))}function D(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,c;return Object(r["b"])(this,(function(r){switch(r.label){case 0:switch(t=Object(i["j"])(e.name),c=t.ext,c){case"ncm":return[3,1];case"uc":return[3,3];case"kwm":return[3,5];case"xm":return[3,7];case"wav":return[3,7];case"mp3":return[3,7];case"flac":return[3,7];case"m4a":return[3,7];case"ogg":return[3,9];case"tm0":return[3,11];case"tm3":return[3,11];case"qmc3":return[3,13];case"qmc2":return[3,13];case"qmc0":return[3,13];case"qmcflac":return[3,13];case"qmcogg":return[3,13];case"tkm":return[3,13];case"bkcmp3":return[3,13];case"bkcflac":return[3,13];case"mflac":return[3,13];case"mgg":return[3,13];case"666c6163":return[3,13];case"6d7033":return[3,13];case"6f6767":return[3,13];case"6d3461":return[3,13];case"776176":return[3,13];case"tm2":return[3,15];case"tm6":return[3,15];case"cache":return[3,17];case"vpr":return[3,19];case"kgm":return[3,19];case"kgma":return[3,19]}return[3,21];case 1:return[4,Object(a["a"])(e.raw,t.name,t.ext)];case 2:return n=r.sent(),[3,22];case 3:return[4,o(e.raw,t.name,t.ext)];case 4:return n=r.sent(),[3,22];case 5:return[4,A(e.raw,t.name,t.ext)];case 6:return n=r.sent(),[3,22];case 7:return[4,d(e.raw,t.name,t.ext)];case 8:return n=r.sent(),[3,22];case 9:return[4,s(e.raw,t.name,t.ext)];case 10:return n=r.sent(),[3,22];case 11:return[4,s(e.raw,t.name,"mp3")];case 12:return n=r.sent(),[3,22];case 13:return[4,Object(b["a"])(e.raw,t.name,t.ext)];case 14:return n=r.sent(),[3,22];case 15:return[4,M(e.raw,t.name)];case 16:return n=r.sent(),[3,22];case 17:return[4,m(e.raw,t.name,t.ext)];case 18:return n=r.sent(),[3,22];case 19:return[4,g(e.raw,t.name,t.ext)];case 20:return n=r.sent(),[3,22];case 21:throw"不支持此文件格式";case 22:return n.rawExt||(n.rawExt=t.ext),n.rawFilename||(n.rawFilename=t.name),console.log(n),[2,n]}}))}))}}});